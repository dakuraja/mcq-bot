import logging
from datetime import timedelta

from telegram import (
    Update,
    InlineKeyboardMarkup,
    InlineKeyboardButton,
)
from telegram.ext import (
    ApplicationBuilder,
    CommandHandler,
    CallbackQueryHandler,
    ContextTypes,
)

# ---------- CONFIG ----------
BOT_TOKEN = "7688080597:AAGdZu38mxpqbBH3fWx_c3hspdPwjiiZKug"   # ‡§Ø‡§π‡§æ‡§Ç ‡§Ö‡§™‡§®‡§æ ‡§Ö‡§∏‡§≤‡•Ä BotFather ‡§µ‡§æ‡§≤‡§æ token ‡§°‡§æ‡§≤‡•á‡§Ç

# ---------- QUESTIONS (Mauryan Empire) ----------
QUESTIONS = [
    {
        "question": "1. ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§∏‡§æ‡§Æ‡•ç‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§æ‡§™‡§®‡§æ ‡§ï‡§ø‡§∏‡§®‡•á ‡§ï‡•Ä?",
        "options": [
            "A) ‡§¨‡§ø‡§®‡•ç‡§¶‡•Å‡§∏‡§æ‡§∞",
            "B) ‡§ö‡§Ç‡§¶‡•ç‡§∞‡§ó‡•Å‡§™‡•ç‡§§ ‡§Æ‡•å‡§∞‡•ç‡§Ø",
            "C) ‡§Ö‡§∂‡•ã‡§ï",
            "D) ‡§™‡•Å‡§∑‡•ç‡§Ø‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§∂‡•Å‡§Ç‡§ó",
        ],
        "correct": "B",
        "explanation": "‡§ö‡§Ç‡§¶‡•ç‡§∞‡§ó‡•Å‡§™‡•ç‡§§ ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§®‡•á 322 ‡§à.‡§™‡•Ç. ‡§Æ‡•á‡§Ç ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§∏‡§æ‡§Æ‡•ç‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ï‡•Ä ‡§∏‡•ç‡§•‡§æ‡§™‡§®‡§æ ‡§ï‡•Ä‡•§",
    },
    {
        "question": "2. ‡§ö‡§Ç‡§¶‡•ç‡§∞‡§ó‡•Å‡§™‡•ç‡§§ ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§ï‡§æ ‡§ó‡•Å‡§∞‡•Å ‡§ï‡•å‡§® ‡§•‡§æ?",
        "options": [
            "A) ‡§µ‡§ø‡§∑‡•ç‡§£‡•Å‡§ó‡•Å‡§™‡•ç‡§§",
            "B) ‡§ö‡§æ‡§£‡§ï‡•ç‡§Ø",
            "C) ‡§™‡§§‡§Ç‡§ú‡§≤‡§ø",
            "D) ‡§Æ‡•á‡§ó‡§∏‡•ç‡§•‡§®‡•Ä‡§ú‡§º",
        ],
        "correct": "B",
        "explanation": "‡§ö‡§æ‡§£‡§ï‡•ç‡§Ø ‡§π‡•Ä ‡§ï‡•å‡§ü‡§ø‡§≤‡•ç‡§Ø/‡§µ‡§ø‡§∑‡•ç‡§£‡•Å‡§ó‡•Å‡§™‡•ç‡§§ ‡§π‡•à‡§Ç, ‡§ú‡§ø‡§®‡•ç‡§π‡•ã‡§Ç‡§®‡•á ‡§ö‡§Ç‡§¶‡•ç‡§∞‡§ó‡•Å‡§™‡•ç‡§§ ‡§ï‡•ã ‡§∏‡§æ‡§Æ‡•ç‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§¶‡§¶ ‡§ï‡•Ä‡•§",
    },
    {
        "question": "3. ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§∏‡§æ‡§Æ‡•ç‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ï‡•Ä ‡§∞‡§æ‡§ú‡§ß‡§æ‡§®‡•Ä ‡§•‡•Ä‚Äî",
        "options": [
            "A) ‡§â‡§ú‡•ç‡§ú‡•à‡§®",
            "B) ‡§§‡§ï‡•ç‡§∑‡§∂‡§ø‡§≤‡§æ",
            "C) ‡§™‡§æ‡§ü‡§≤‡§ø‡§™‡•Å‡§§‡•ç‡§∞",
            "D) ‡§ï‡•å‡§∂‡§æ‡§Æ‡•ç‡§¨‡•Ä",
        ],
        "correct": "C",
        "explanation": "‡§™‡§æ‡§ü‡§≤‡§ø‡§™‡•Å‡§§‡•ç‡§∞ (‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï ‡§™‡§ü‡§®‡§æ) ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§∏‡§æ‡§Æ‡•ç‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ï‡•Ä ‡§∞‡§æ‡§ú‡§ß‡§æ‡§®‡•Ä ‡§•‡•Ä‡•§",
    },
    {
        "question": "4. ‡§Æ‡•á‡§ó‡§∏‡•ç‡§•‡§®‡•Ä‡§ú‡§º ‡§ï‡§ø‡§∏‡§ï‡•á ‡§¶‡§∞‡§¨‡§æ‡§∞ ‡§Æ‡•á‡§Ç ‡§Ü‡§Ø‡§æ?",
        "options": [
            "A) ‡§Ö‡§∂‡•ã‡§ï",
            "B) ‡§¨‡§ø‡§®‡•ç‡§¶‡•Å‡§∏‡§æ‡§∞",
            "C) ‡§ö‡§Ç‡§¶‡•ç‡§∞‡§ó‡•Å‡§™‡•ç‡§§ ‡§Æ‡•å‡§∞‡•ç‡§Ø",
            "D) ‡§¨‡•É‡§π‡§¶‡•ç‡§∞‡§•",
        ],
        "correct": "C",
        "explanation": "‡§Æ‡•á‡§ó‡§∏‡•ç‡§•‡§®‡•Ä‡§ú‡§º ‡§∏‡•á‡§≤‡•ç‡§Ø‡•Ç‡§ï‡§∏ ‡§®‡§ø‡§ï‡•á‡§ü‡§∞ ‡§ï‡§æ ‡§¶‡•Ç‡§§ ‡§•‡§æ ‡§î‡§∞ ‡§ö‡§Ç‡§¶‡•ç‡§∞‡§ó‡•Å‡§™‡•ç‡§§ ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§ï‡•á ‡§¶‡§∞‡§¨‡§æ‡§∞ ‡§Æ‡•á‡§Ç ‡§Ü‡§Ø‡§æ‡•§",
    },
    {
        "question": "5. ‡§Æ‡•á‡§ó‡§∏‡•ç‡§•‡§®‡•Ä‡§ú‡§º ‡§ï‡•Ä ‡§™‡•Å‡§∏‡•ç‡§§‡§ï ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§π‡•à‚Äî",
        "options": [
            "A) ‡§Æ‡§ø‡§≤‡§ø‡§Ç‡§¶‡§™‡§®‡•ç‡§π‡•ã",
            "B) ‡§á‡§Ç‡§°‡§ø‡§ï‡§æ",
            "C) ‡§ï‡§•‡§æ‡§µ‡§§‡•ç‡§•‡•Å",
            "D) ‡§Æ‡•Å‡§¶‡•ç‡§∞‡§æ‡§∞‡§æ‡§ï‡•ç‡§∑‡§∏",
        ],
        "correct": "B",
        "explanation": "‡§á‡§Ç‡§°‡§ø‡§ï‡§æ ‡§Æ‡•á‡§Ç ‡§≠‡§æ‡§∞‡§§ ‡§ï‡•á ‡§∏‡§Æ‡§æ‡§ú, ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§® ‡§î‡§∞ ‡§ú‡•Ä‡§µ‡§® ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§π‡•à‡•§",
    },
    {
        "question": "6. ‡§ö‡§Ç‡§¶‡•ç‡§∞‡§ó‡•Å‡§™‡•ç‡§§ ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§®‡•á ‡§ï‡§ø‡§∏ ‡§Ø‡•Ç‡§®‡§æ‡§®‡•Ä ‡§∂‡§æ‡§∏‡§ï ‡§ï‡•ã ‡§™‡§∞‡§æ‡§ú‡§ø‡§§ ‡§ï‡§ø‡§Ø‡§æ?",
        "options": [
            "A) ‡§è‡§Ç‡§ü‡§ø‡§Ø‡•ã‡§ï‡§∏",
            "B) ‡§∏‡•á‡§≤‡•ç‡§Ø‡•Ç‡§ï‡§∏ ‡§®‡§ø‡§ï‡•á‡§ü‡§∞",
            "C) ‡§°‡•á‡§Æ‡•á‡§ü‡•ç‡§∞‡§ø‡§Ø‡§∏",
            "D) ‡§Æ‡§ø‡§®‡•á‡§Ç‡§°‡§∞",
        ],
        "correct": "B",
        "explanation": "‡§ö‡§Ç‡§¶‡•ç‡§∞‡§ó‡•Å‡§™‡•ç‡§§ ‡§®‡•á ‡§∏‡•á‡§≤‡•ç‡§Ø‡•Ç‡§ï‡§∏ ‡§®‡§ø‡§ï‡•á‡§ü‡§∞ ‡§ï‡•ã ‡§π‡§∞‡§æ‡§ï‡§∞ ‡§â‡§∏‡§ï‡•á ‡§∏‡§æ‡§• ‡§∏‡§Ç‡§ß‡§ø ‡§ï‡•Ä ‡§î‡§∞ ‡§ï‡§à ‡§™‡•ç‡§∞‡§¶‡•á‡§∂ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ï‡§ø‡§è‡•§",
    },
    {
        "question": "7. ‡§Ö‡§∂‡•ã‡§ï ‡§®‡•á ‡§ï‡§ø‡§∏ ‡§Ø‡•Å‡§¶‡•ç‡§ß ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§¨‡•å‡§¶‡•ç‡§ß ‡§ß‡§∞‡•ç‡§Æ ‡§Ö‡§™‡§®‡§æ‡§Ø‡§æ?",
        "options": [
            "A) ‡§™‡§æ‡§ü‡§≤‡§ø‡§™‡•Å‡§§‡•ç‡§∞ ‡§Ø‡•Å‡§¶‡•ç‡§ß",
            "B) ‡§∞‡§æ‡§ú‡§ó‡•É‡§π ‡§Ø‡•Å‡§¶‡•ç‡§ß",
            "C) ‡§ï‡•å‡§∂‡§æ‡§Ç‡§¨‡•Ä ‡§Ø‡•Å‡§¶‡•ç‡§ß",
            "D) ‡§ï‡§≤‡§ø‡§Ç‡§ó ‡§Ø‡•Å‡§¶‡•ç‡§ß",
        ],
        "correct": "D",
        "explanation": "‡§ï‡§≤‡§ø‡§Ç‡§ó ‡§Ø‡•Å‡§¶‡•ç‡§ß ‡§ï‡•Ä ‡§≠‡•Ä‡§∑‡§£ ‡§π‡§æ‡§®‡§ø ‡§¶‡•á‡§ñ‡§ï‡§∞ ‡§Ö‡§∂‡•ã‡§ï ‡§π‡§ø‡§Ç‡§∏‡§æ ‡§∏‡•á ‡§µ‡§ø‡§∞‡§ï‡•ç‡§§ ‡§π‡•Å‡§Ü ‡§î‡§∞ ‡§¨‡•å‡§¶‡•ç‡§ß ‡§ß‡§∞‡•ç‡§Æ ‡§Ö‡§™‡§®‡§æ ‡§≤‡§ø‡§Ø‡§æ‡•§",
    },
    {
        "question": "8. ‡§ï‡§≤‡§ø‡§Ç‡§ó ‡§Ø‡•Å‡§¶‡•ç‡§ß ‡§ï‡§¨ ‡§π‡•Å‡§Ü?",
        "options": [
            "A) 321 ‡§à.‡§™‡•Ç.",
            "B) 273 ‡§à.‡§™‡•Ç.",
            "C) 261 ‡§à.‡§™‡•Ç.",
            "D) 185 ‡§à.‡§™‡•Ç.",
        ],
        "correct": "C",
        "explanation": "‡§ï‡§≤‡§ø‡§Ç‡§ó ‡§Ø‡•Å‡§¶‡•ç‡§ß 261 ‡§à.‡§™‡•Ç. ‡§Æ‡•á‡§Ç ‡§π‡•Å‡§Ü, ‡§Ø‡§π ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§ò‡§ü‡§®‡§æ ‡§π‡•à‡•§",
    },
    {
        "question": "9. ‡§Ö‡§∂‡•ã‡§ï ‡§®‡•á ‡§ï‡§ø‡§∏ ‡§¨‡•å‡§¶‡•ç‡§ß ‡§™‡§∞‡§ø‡§∑‡§¶ ‡§ï‡§æ ‡§Ü‡§Ø‡•ã‡§ú‡§® ‡§ï‡§∞‡§µ‡§æ‡§Ø‡§æ?",
        "options": [
            "A) ‡§™‡•ç‡§∞‡§•‡§Æ",
            "B) ‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø",
            "C) ‡§§‡•É‡§§‡•Ä‡§Ø",
            "D) ‡§ö‡§§‡•Å‡§∞‡•ç‡§•",
        ],
        "correct": "C",
        "explanation": "‡§Ö‡§∂‡•ã‡§ï ‡§®‡•á ‡§§‡•É‡§§‡•Ä‡§Ø ‡§¨‡•å‡§¶‡•ç‡§ß ‡§™‡§∞‡§ø‡§∑‡§¶ ‡§™‡§æ‡§ü‡§≤‡§ø‡§™‡•Å‡§§‡•ç‡§∞ ‡§Æ‡•á‡§Ç ‡§Ü‡§Ø‡•ã‡§ú‡§ø‡§§ ‡§ï‡§∞‡§µ‡§æ‡§à‡•§",
    },
    {
        "question": "10. ‡§§‡•É‡§§‡•Ä‡§Ø ‡§¨‡•å‡§¶‡•ç‡§ß ‡§™‡§∞‡§ø‡§∑‡§¶ ‡§ï‡§æ ‡§Ö‡§ß‡•ç‡§Ø‡§ï‡•ç‡§∑ ‡§•‡§æ‚Äî",
        "options": [
            "A) ‡§µ‡§∏‡•Å‡§Æ‡§ø‡§§‡•ç‡§∞",
            "B) ‡§®‡§æ‡§ó‡§∏‡•á‡§®",
            "C) ‡§Æ‡•ã‡§ó‡•ç‡§ó‡§≤‡§ø‡§™‡•Å‡§§‡•ç‡§§ ‡§§‡§ø‡§∏‡•ç‡§∏",
            "D) ‡§â‡§™‡§ó‡•Å‡§™‡•ç‡§§",
        ],
        "correct": "C",
        "explanation": "‡§§‡•É‡§§‡•Ä‡§Ø ‡§¨‡•å‡§¶‡•ç‡§ß ‡§™‡§∞‡§ø‡§∑‡§¶ ‡§ï‡•Ä ‡§Ö‡§ß‡•ç‡§Ø‡§ï‡•ç‡§∑‡§§‡§æ ‡§Æ‡•ã‡§ó‡•ç‡§ó‡§≤‡§ø‡§™‡•Å‡§§‡•ç‡§§ ‡§§‡§ø‡§∏‡•ç‡§∏ ‡§®‡•á ‡§ï‡•Ä‡•§",
    },
    {
        "question": "11. ‡§Ö‡§∂‡•ã‡§ï ‡§ï‡•á ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§Ç‡§∂ ‡§∂‡§ø‡§≤‡§æ‡§≤‡•á‡§ñ ‡§ï‡§ø‡§∏ ‡§≤‡§ø‡§™‡§ø ‡§Æ‡•á‡§Ç ‡§π‡•à‡§Ç?",
        "options": [
            "A) ‡§¶‡•á‡§µ‡§®‡§æ‡§ó‡§∞‡•Ä",
            "B) ‡§¨‡•ç‡§∞‡§æ‡§π‡•ç‡§Æ‡•Ä",
            "C) ‡§ñ‡§∞‡•ã‡§∑‡•ç‡§†‡•Ä",
            "D) ‡§Ö‡§∞‡•á‡§Æ‡§æ‡§á‡§ï",
        ],
        "correct": "B",
        "explanation": "‡§Ö‡§∂‡•ã‡§ï ‡§ï‡•á ‡§Ö‡§ß‡§ø‡§ï‡§§‡§∞ ‡§∂‡§ø‡§≤‡§æ‡§≤‡•á‡§ñ ‡§¨‡•ç‡§∞‡§æ‡§π‡•ç‡§Æ‡•Ä ‡§≤‡§ø‡§™‡§ø ‡§Æ‡•á‡§Ç ‡§π‡•à‡§Ç, ‡§â‡§§‡•ç‡§§‡§∞-‡§™‡§∂‡•ç‡§ö‡§ø‡§Æ ‡§Æ‡•á‡§Ç ‡§ñ‡§∞‡•ã‡§∑‡•ç‡§†‡•Ä ‡§≠‡•Ä‡•§",
    },
    {
        "question": "12. ‡§Ö‡§∂‡•ã‡§ï ‡§ï‡•á ‡§∂‡§ø‡§≤‡§æ‡§≤‡•á‡§ñ‡•ã‡§Ç ‡§ï‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§§‡§É‚Äî",
        "options": [
            "A) ‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§",
            "B) ‡§™‡§æ‡§≤‡•Ä",
            "C) ‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§",
            "D) ‡§§‡§ø‡§¨‡•ç‡§¨‡§§‡•Ä",
        ],
        "correct": "C",
        "explanation": "‡§Ö‡§ß‡§ø‡§ï‡§æ‡§Ç‡§∂ ‡§Ö‡§≠‡§ø‡§≤‡•á‡§ñ ‡§∏‡§æ‡§ß‡§æ‡§∞‡§£ ‡§≤‡•ã‡§ó‡•ã‡§Ç ‡§ï‡•Ä ‡§∏‡§Æ‡§ù ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§ ‡§≠‡§æ‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§≤‡§ø‡§ñ‡•á ‡§ó‡§è‡•§",
    },
    {
        "question": "13. ‡§Ö‡§∂‡•ã‡§ï ‡§ï‡•á ‡§Ü‡§ß‡•ç‡§Ø‡§æ‡§§‡•ç‡§Æ‡§ø‡§ï ‡§ó‡•Å‡§∞‡•Å ‡§•‡•á‚Äî",
        "options": [
            "A) ‡§â‡§™‡§ó‡•Å‡§™‡•ç‡§§",
            "B) ‡§®‡§æ‡§ó‡§æ‡§∞‡•ç‡§ú‡•Å‡§®",
            "C) ‡§Ü‡§®‡§Ç‡§¶",
            "D) ‡§Ö‡§∏‡§Ç‡§ó",
        ],
        "correct": "A",
        "explanation": "‡§™‡§∞‡§Ç‡§™‡§∞‡§æ ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§â‡§™‡§ó‡•Å‡§™‡•ç‡§§ ‡§ï‡•ã ‡§Ö‡§∂‡•ã‡§ï ‡§ï‡§æ ‡§Ü‡§ß‡•ç‡§Ø‡§æ‡§§‡•ç‡§Æ‡§ø‡§ï ‡§ó‡•Å‡§∞‡•Å ‡§Æ‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à‡•§",
    },
    {
        "question": "14. ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§® ‡§Æ‡•á‡§Ç \"‡§Ö‡§Æ‡§§‡•ç‡§Ø\" ‡§ï‡§æ ‡§Ö‡§∞‡•ç‡§• ‡§π‡•à‚Äî",
        "options": [
            "A) ‡§∏‡•à‡§®‡§ø‡§ï",
            "B) ‡§ú‡§æ‡§∏‡•Ç‡§∏",
            "C) ‡§Æ‡§Ç‡§§‡•ç‡§∞‡•Ä/‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä",
            "D) ‡§ï‡§∞ ‡§∏‡§Ç‡§ó‡•ç‡§∞‡§æ‡§π‡§ï",
        ],
        "correct": "C",
        "explanation": "‡§Ö‡§Æ‡§§‡•ç‡§Ø ‡§â‡§ö‡•ç‡§ö ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§®‡§ø‡§ï ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä ‡§Ø‡§æ ‡§Æ‡§Ç‡§§‡•ç‡§∞‡•Ä ‡§•‡•á, ‡§ú‡•ã ‡§∂‡§æ‡§∏‡§® ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§Æ‡•á‡§Ç ‡§∏‡§π‡§æ‡§Ø‡§ï ‡§•‡•á‡•§",
    },
    {
        "question": "15. ‚Äú‡§ß‡§Æ‡•ç‡§Æ‚Äù ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ö‡§æ‡§∞ ‡§ï‡§ø‡§∏ ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§∂‡§æ‡§∏‡§ï ‡§®‡•á ‡§ï‡§ø‡§Ø‡§æ?",
        "options": [
            "A) ‡§¨‡§ø‡§®‡•ç‡§¶‡•Å‡§∏‡§æ‡§∞",
            "B) ‡§Ö‡§∂‡•ã‡§ï",
            "C) ‡§¶‡§∂‡§∞‡§•",
            "D) ‡§ï‡•Å‡§®‡§æ‡§≤",
        ],
        "correct": "B",
        "explanation": "‡§Ö‡§∂‡•ã‡§ï ‡§®‡•á \"‡§ß‡§Æ‡•ç‡§Æ\" ‡§®‡•Ä‡§§‡§ø ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§®‡•à‡§§‡§ø‡§ï ‡§ú‡•Ä‡§µ‡§®, ‡§∏‡§π‡§ø‡§∑‡•ç‡§£‡•Å‡§§‡§æ ‡§î‡§∞ ‡§Ö‡§π‡§ø‡§Ç‡§∏‡§æ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§ö‡§æ‡§∞ ‡§ï‡§ø‡§Ø‡§æ‡•§",
    },
    {
        "question": "16. ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§ï‡§æ‡§≤ ‡§Æ‡•á‡§Ç \"‡§∏‡§Ç‡§ò\" ‡§ï‡§æ ‡§Ö‡§∞‡•ç‡§• ‡§π‡•à‚Äî",
        "options": [
            "A) ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§®‡§ø‡§ï ‡§µ‡§ø‡§≠‡§æ‡§ó",
            "B) ‡§ï‡§ø‡§∏‡§æ‡§® ‡§∏‡§Ç‡§ò",
            "C) ‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞ ‡§∏‡§Ç‡§ó‡§†‡§®",
            "D) ‡§¨‡•å‡§¶‡•ç‡§ß ‡§≠‡§ø‡§ï‡•ç‡§∑‡•Å‡§ì‡§Ç ‡§ï‡§æ ‡§∏‡§Ç‡§ó‡§†‡§®",
        ],
        "correct": "D",
        "explanation": "‡§∏‡§Ç‡§ò ‡§∏‡•á ‡§Ü‡§∂‡§Ø ‡§¨‡•å‡§¶‡•ç‡§ß ‡§≠‡§ø‡§ï‡•ç‡§∑‡•Å‡§ì‡§Ç ‡§ï‡•á ‡§∏‡§Ç‡§ó‡§†‡§ø‡§§ ‡§∏‡§Æ‡•Å‡§¶‡§æ‡§Ø ‡§∏‡•á ‡§•‡§æ‡•§",
    },
    {
        "question": "17. ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§ï‡§æ‡§≤ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§Æ‡•Å‡§ñ ‡§ï‡§∞ ‡§ï‡•å‡§® ‡§∏‡§æ ‡§•‡§æ?",
        "options": [
            "A) ‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞ ‡§ï‡§∞",
            "B) ‡§Æ‡§®‡•ã‡§∞‡§Ç‡§ú‡§® ‡§ï‡§∞",
            "C) ‡§≠‡•Ç-‡§ï‡§∞",
            "D) ‡§µ‡§® ‡§ï‡§∞",
        ],
        "correct": "C",
        "explanation": "‡§ï‡•É‡§∑‡§ø ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§Ö‡§∞‡•ç‡§•‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§ï‡§æ‡§∞‡§£ ‡§≠‡•Ç‡§Æ‡§ø ‡§ï‡§∞ ‡§π‡•Ä ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∞‡§æ‡§ú‡§∏‡•ç‡§µ ‡§∏‡•ç‡§∞‡•ã‡§§ ‡§•‡§æ‡•§",
    },
    {
        "question": "18. ‡§Ö‡§∞‡•ç‡§•‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞ ‡§ï‡§æ ‡§≤‡•á‡§ñ‡§ï ‡§ï‡•å‡§® ‡§π‡•à?",
        "options": [
            "A) ‡§µ‡§ø‡§∑‡•ç‡§£‡•Å ‡§∂‡§∞‡•ç‡§Æ‡§æ",
            "B) ‡§ï‡§æ‡§≤‡§ø‡§¶‡§æ‡§∏",
            "C) ‡§ö‡§æ‡§£‡§ï‡•ç‡§Ø",
            "D) ‡§™‡§æ‡§£‡§ø‡§®‡§ø",
        ],
        "correct": "C",
        "explanation": "‡§ï‡•å‡§ü‡§ø‡§≤‡•ç‡§Ø/‡§ö‡§æ‡§£‡§ï‡•ç‡§Ø ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§∞‡§ö‡§ø‡§§ ‡§Ö‡§∞‡•ç‡§•‡§∂‡§æ‡§∏‡•ç‡§§‡•ç‡§∞ ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§® ‡§ï‡§æ ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ó‡•ç‡§∞‡§Ç‡§• ‡§π‡•à‡•§",
    },
    {
        "question": "19. ‡§ï‡§ø‡§∏‡•á ‡§Ö‡§∂‡•ã‡§ï ‡§®‡•á ‡§∂‡•ç‡§∞‡•Ä‡§≤‡§Ç‡§ï‡§æ ‡§≠‡•á‡§ú‡§æ?",
        "options": [
            "A) ‡§´‡§æ‡§π‡•ç‡§Ø‡§æ‡§®",
            "B) ‡§π‡•ç‡§µ‡•á‡§®‡§∏‡§æ‡§Ç‡§ó",
            "C) ‡§Æ‡§π‡•á‡§Ç‡§¶‡•ç‡§∞ ‡§µ ‡§∏‡§Ç‡§ò‡§Æ‡§ø‡§§‡•ç‡§∞‡§æ",
            "D) ‡§®‡§æ‡§ó‡§æ‡§∞‡•ç‡§ú‡•Å‡§®",
        ],
        "correct": "C",
        "explanation": "‡§Ö‡§∂‡•ã‡§ï ‡§®‡•á ‡§Ö‡§™‡§®‡•á ‡§™‡•Å‡§§‡•ç‡§∞ ‡§Æ‡§π‡•á‡§Ç‡§¶‡•ç‡§∞ ‡§î‡§∞ ‡§™‡•Å‡§§‡•ç‡§∞‡•Ä ‡§∏‡§Ç‡§ò‡§Æ‡§ø‡§§‡•ç‡§∞‡§æ ‡§ï‡•ã ‡§¨‡•å‡§¶‡•ç‡§ß ‡§ß‡§∞‡•ç‡§Æ ‡§™‡•ç‡§∞‡§ö‡§æ‡§∞ ‡§π‡•á‡§§‡•Å ‡§∂‡•ç‡§∞‡•Ä‡§≤‡§Ç‡§ï‡§æ ‡§≠‡•á‡§ú‡§æ‡•§",
    },
    {
        "question": "20. ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§ï‡§æ‡§≤ ‡§ï‡§æ \"‡§ß‡§®‡§ï\" ‡§ï‡§ø‡§∏‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§•‡§æ?",
        "options": [
            "A) ‡§ï‡•É‡§∑‡§ø",
            "B) ‡§ß‡§æ‡§§‡•Å ‡§ï‡§æ‡§∞‡•ç‡§Ø",
            "C) ‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞",
            "D) ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ",
        ],
        "correct": "B",
        "explanation": "‡§ß‡§®‡§ï ‡§∂‡§¨‡•ç‡§¶ ‡§ï‡§æ ‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó ‡§≤‡•ã‡§π‡§æ‡§∞/‡§ß‡§æ‡§§‡•Å ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡•á ‡§µ‡§∞‡•ç‡§ó ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•ã‡§§‡§æ ‡§•‡§æ‡•§",
    },
    {
        "question": "21. ‡§Ö‡§∂‡•ã‡§ï ‡§ï‡•á ‡§∂‡§ø‡§≤‡§æ‡§≤‡•á‡§ñ‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§¨‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§ï‡§ø‡§∏‡§®‡•á ‡§™‡§¢‡§º‡§æ?",
        "options": [
            "A) ‡§ï‡§®‡§ø‡§Ç‡§ò‡§Æ",
            "B) ‡§ú‡•á‡§Æ‡•ç‡§∏ ‡§™‡•ç‡§∞‡§ø‡§Ç‡§∏‡•á‡§™",
            "C) ‡§∏‡•ç‡§Æ‡§ø‡§•",
            "D) ‡§Æ‡§æ‡§∞‡•ç‡§∂‡§≤",
        ],
        "correct": "B",
        "explanation": "‡§ú‡•á‡§Æ‡•ç‡§∏ ‡§™‡•ç‡§∞‡§ø‡§Ç‡§∏‡•á‡§™ ‡§®‡•á 1837 ‡§à. ‡§Æ‡•á‡§Ç ‡§¨‡•ç‡§∞‡§æ‡§π‡•ç‡§Æ‡•Ä ‡§≤‡§ø‡§™‡§ø ‡§ï‡•ã ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§™‡§¢‡§º‡§æ‡•§",
    },
    {
        "question": "22. ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§∏‡§æ‡§Æ‡•ç‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§Æ‡•á‡§Ç ‡§≠‡•Ç‡§Æ‡§ø ‡§Æ‡§æ‡§™‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä‚Äî",
        "options": [
            "A) ‡§≤‡§ø‡§™‡§ø‡§ï",
            "B) ‡§®‡§ó‡§∞‡§ø‡§ï",
            "C) ‡§∏‡§Ç‡§ß‡§ø‡§µ‡§ø‡§ó‡•ç‡§∞‡§π‡§ï",
            "D) ‡§ï‡•ã‡§∑‡§æ‡§ß‡•ç‡§Ø‡§ï‡•ç‡§∑",
        ],
        "correct": "A",
        "explanation": "‡§≤‡§ø‡§™‡§ø‡§ï ‡§≠‡•Ç‡§Æ‡§ø ‡§Æ‡§æ‡§™‡§®, ‡§≤‡•á‡§ñ‡§æ ‡§µ ‡§Ö‡§≠‡§ø‡§≤‡•á‡§ñ ‡§ï‡§æ ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞‡§§‡§æ ‡§•‡§æ‡•§",
    },
    {
        "question": "23. ‡§Ö‡§∂‡•ã‡§ï ‡§ï‡•á ‡§Ö‡§≠‡§ø‡§≤‡•á‡§ñ‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‚Äú‡§∞‡§æ‡§ú‡•Å‡§ï‚Äù ‡§ï‡•å‡§® ‡§•‡§æ?",
        "options": [
            "A) ‡§®‡•ç‡§Ø‡§æ‡§Ø‡§ß‡•Ä‡§∂",
            "B) ‡§Æ‡§Ç‡§§‡•ç‡§∞‡•Ä",
            "C) ‡§ú‡§ø‡§≤‡§æ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä",
            "D) ‡§¶‡§Ç‡§°‡§æ‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä",
        ],
        "correct": "C",
        "explanation": "‡§∞‡§æ‡§ú‡•Å‡§ï ‡§Ü‡§ß‡•Å‡§®‡§ø‡§ï ‡§Ö‡§∞‡•ç‡§•‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§ú‡§ø‡§≤‡§æ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä ‡§ú‡•à‡§∏‡§æ ‡§™‡§¶ ‡§•‡§æ ‡§ú‡•ã ‡§™‡•ç‡§∞‡§∂‡§æ‡§∏‡§® ‡§µ ‡§®‡•ç‡§Ø‡§æ‡§Ø ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§¶‡•á‡§ñ‡§§‡§æ ‡§•‡§æ‡•§",
    },
    {
        "question": "24. ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§∏‡§æ‡§Æ‡•ç‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ï‡§æ ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§∂‡§æ‡§∏‡§ï ‡§•‡§æ‚Äî",
        "options": [
            "A) ‡§¶‡§∂‡§∞‡§•",
            "B) ‡§ï‡•Å‡§£‡§æ‡§≤",
            "C) ‡§¨‡•É‡§π‡§¶‡•ç‡§∞‡§•",
            "D) ‡§¨‡§ø‡§®‡•ç‡§¶‡•Å‡§∏‡§æ‡§∞",
        ],
        "correct": "C",
        "explanation": "‡§¨‡•É‡§π‡§¶‡•ç‡§∞‡§• ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§∂‡§æ‡§∏‡§ï ‡§•‡§æ, ‡§ú‡§ø‡§∏‡§ï‡•Ä ‡§π‡§§‡•ç‡§Ø‡§æ ‡§™‡•Å‡§∑‡•ç‡§Ø‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§∂‡•Å‡§Ç‡§ó ‡§®‡•á ‡§ï‡•Ä‡•§",
    },
    {
        "question": "25. ‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§ï‡§æ‡§≤ ‡§ï‡•á ‡§∏‡§ø‡§ï‡•ç‡§ï‡•á ‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§§‡§É ‡§ï‡§ø‡§∏ ‡§ß‡§æ‡§§‡•Å ‡§ï‡•á ‡§•‡•á?",
        "options": [
            "A) ‡§∏‡•ã‡§®‡§æ",
            "B) ‡§§‡§æ‡§Ç‡§¨‡§æ",
            "C) ‡§ö‡§æ‡§Å‡§¶‡•Ä",
            "D) ‡§≤‡•ã‡§π‡§æ",
        ],
        "correct": "C",
        "explanation": "‡§Æ‡•å‡§∞‡•ç‡§Ø ‡§ï‡§æ‡§≤ ‡§ï‡•á ‡§™‡§Ç‡§ö-‡§ö‡§ø‡§π‡•ç‡§®‡§ø‡§§ (Punch-marked) ‡§∏‡§ø‡§ï‡•ç‡§ï‡•á ‡§™‡•ç‡§∞‡§æ‡§Ø‡§É ‡§ö‡§æ‡§Å‡§¶‡•Ä ‡§ï‡•á ‡§π‡•ã‡§§‡•á ‡§•‡•á‡•§",
    },
]


# ---------- LOGGING ----------
logging.basicConfig(
    format="%(asctime)s - %(name)s - %(levelname)s - %(message)s",
    level=logging.INFO,
)
logger = logging.getLogger(__name__)


# ---------- HELPER: ADMIN CHECK ----------
async def is_admin(update: Update, context: ContextTypes.DEFAULT_TYPE) -> bool:
    chat = update.effective_chat
    user = update.effective_user

    if chat.type not in ("group", "supergroup"):
        # ‡§™‡•ç‡§∞‡§æ‡§á‡§µ‡•á‡§ü ‡§ö‡•à‡§ü ‡§Æ‡•á‡§Ç ‡§∏‡§¨‡§ï‡•ã allow
        return True

    member = await context.bot.get_chat_member(chat.id, user.id)
    return member.status in ("administrator", "creator")


# ---------- SEND ONE QUESTION ----------
async def send_question(
    update: Update, context: ContextTypes.DEFAULT_TYPE, q_index: int
):
    question_data = QUESTIONS[q_index]
    context.user_data["q_index"] = q_index

    buttons = [
        [InlineKeyboardButton(text=opt, callback_data=f"answer_{i}")]
        for i, opt in enumerate(question_data["options"])
    ]
    markup = InlineKeyboardMarkup(buttons)

    text = question_data["question"]

    if update.callback_query:
        await update.callback_query.message.reply_text(text=text, reply_markup=markup)
    else:
        await update.message.reply_text(text=text, reply_markup=markup)


# ---------- /start ----------
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "‡§®‡§Æ‡§∏‡•ç‡§§‡•á! üëã\n"
        "‡§Æ‡•à‡§Ç Mauryan Empire MCQ Quiz Bot ‡§π‡•Ç‡§Å.\n\n"
        "‚ñ∂ ‡§™‡•ç‡§∞‡§æ‡§á‡§µ‡•á‡§ü ‡§ö‡•à‡§ü ‡§Æ‡•á‡§Ç: /quiz ‡§≠‡•á‡§ú‡§ï‡§∞ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç\n"
        "‚ñ∂ ‡§ó‡•ç‡§∞‡•Å‡§™ ‡§Æ‡•á‡§Ç: ‡§ï‡•á‡§µ‡§≤ *admin* /quiz ‡§ö‡§≤‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à\n\n"
        "Commands:\n"
        "‚Ä¢ /quiz ‚Äì ‡§™‡•Ç‡§∞‡§æ MCQ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º\n"
        "‚Ä¢ /leaderboard ‚Äì ‡§ü‡•â‡§™ ‡§∏‡•ç‡§ï‡•ã‡§∞\n"
        "‚Ä¢ /daily_on ‚Äì ‡§∞‡•ã‡§ú‡§º ‡§è‡§ï ‡§∏‡§µ‡§æ‡§≤ (chat ‡§ï‡•á ‡§≤‡§ø‡§è)\n"
        "‚Ä¢ /daily_off ‚Äì daily quiz ‡§¨‡§Ç‡§¶\n"
    )


# ---------- QUIZ START ( /quiz ) ----------
async def quiz_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    # admin check (group ‡§Æ‡•á‡§Ç)
    if not await is_admin(update, context):
        await update.message.reply_text("‡§ï‡•á‡§µ‡§≤ *admin* /quiz ‡§ö‡§≤‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§", parse_mode="Markdown")
        return

    # user ‡§ï‡§æ ‡§Ö‡§™‡§®‡§æ score reset
    context.user_data["score"] = 0
    context.user_data["q_index"] = 0

    await update.message.reply_text(
        "üéØ Mauryan Empire MCQ Quiz ‡§∂‡•Å‡§∞‡•Ç!\n"
        "‡§π‡§∞ ‡§∏‡§µ‡§æ‡§≤ ‡§ï‡•á ‡§∏‡§π‡•Ä ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§™‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§ï ‡§ï‡§∞‡•á‡§Ç‡•§"
    )

    await send_question(update, context, 0)


# ---------- HANDLE ANSWER (inline buttons) ----------
async def handle_answer(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.callback_query
    await query.answer()

    selected = int(query.data.split("_")[1])
    q_index = context.user_data.get("q_index", 0)

    question = QUESTIONS[q_index]

    # correct letter -> index
    letters = ["A", "B", "C", "D"]
    correct_letter = question["correct"].upper().strip()
    try:
        correct_index = letters.index(correct_letter)
    except ValueError:
        # ‡§Ö‡§ó‡§∞ ‡§ó‡§≤‡§§‡•Ä ‡§∏‡•á wrong data ‡§π‡•ã
        correct_index = 0

    # ‡§∏‡§π‡•Ä/‡§ó‡§≤‡§§ ‡§ö‡•á‡§ï
    if selected == correct_index:
        context.user_data["score"] = context.user_data.get("score", 0) + 1
        feedback = "‚úÖ ‡§∏‡§π‡•Ä ‡§ú‡§µ‡§æ‡§¨!"
    else:
        feedback = f"‚ùå ‡§ó‡§≤‡§§.\n‡§∏‡§π‡•Ä ‡§ú‡§µ‡§æ‡§¨: {question['options'][correct_index]}"

    await query.message.reply_text(feedback)

    # explanation
    explanation = question.get("explanation")
    if explanation:
        await query.message.reply_text(f"‚ÑπÔ∏è ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ:\n{explanation}")

    # ‡§Ö‡§ó‡§≤‡§æ question ‡§Ø‡§æ finish
    next_q = q_index + 1
    if next_q < len(QUESTIONS):
        await send_question(update, context, next_q)
    else:
        score = context.user_data.get("score", 0)
        total = len(QUESTIONS)

        # LEADERBOARD update
        app_data = context.application.bot_data.setdefault("leaderboard", {})
        chat_id = update.effective_chat.id
        chat_board = app_data.setdefault(chat_id, {})

        user = update.effective_user
        display_name = user.full_name or user.username or str(user.id)

        prev = chat_board.get(user.id)
        if (not prev) or (score > prev["score"]):
            chat_board[user.id] = {"score": score, "name": display_name}

        await query.message.reply_text(
            f"üéâ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§!\n‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§ï‡•ã‡§∞: *{score}/{total}*\n"
            "‡§´‡§ø‡§∞ ‡§∏‡•á ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è /quiz ‡§≠‡•á‡§ú‡•á‡§Ç‡•§",
            parse_mode="Markdown",
        )
        context.user_data.clear()


# ---------- /leaderboard ----------
async def leaderboard(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id
    app_data = context.application.bot_data.get("leaderboard", {})
    chat_board = app_data.get(chat_id, {})

    if not chat_board:
        await update.message.reply_text("‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡§ø‡§∏‡•Ä ‡§®‡•á ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§™‡•Ç‡§∞‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§ø‡§Ø‡§æ‡•§ üôÇ")
        return

    # high to low sort
    sorted_scores = sorted(
        chat_board.items(), key=lambda x: x[1]["score"], reverse=True
    )

    lines = ["üèÜ *Leaderboard*"]
    for rank, (user_id, data) in enumerate(sorted_scores[:10], start=1):
        lines.append(f"{rank}. {data['name']} ‚Äî {data['score']}")

    await update.message.reply_text("\n".join(lines), parse_mode="Markdown")


# ---------- DAILY QUIZ JOB ----------
async def daily_quiz_job(context: ContextTypes.DEFAULT_TYPE):
    job_data = context.job.data
    chat_id = job_data["chat_id"]

    # simple: ‡§π‡§Æ‡•á‡§∂‡§æ ‡§™‡§π‡§≤‡§æ ‡§∏‡§µ‡§æ‡§≤ ‡§Ø‡§æ random ‡§≠‡•Ä ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç
    question_index = 0
    question = QUESTIONS[question_index]

    buttons = [
        [InlineKeyboardButton(text=opt, callback_data=f"answer_{i}")]
        for i, opt in enumerate(question["options"])
    ]
    markup = InlineKeyboardMarkup(buttons)

    await context.bot.send_message(
        chat_id=chat_id,
        text="üìÖ Daily Quiz:\n" + question["question"],
        reply_markup=markup,
    )


# ---------- /daily_on ----------
async def daily_on(update: Update, context: ContextTypes.DEFAULT_TYPE):
    if not await is_admin(update, context):
        await update.message.reply_text("‡§ï‡•á‡§µ‡§≤ admin daily quiz ‡§∏‡•á‡§ü ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§")
        return

    chat_id = update.effective_chat.id

    # ‡§™‡§π‡§≤‡•á ‡§∏‡•á job ‡§π‡•ã ‡§§‡•ã ‡§π‡§ü‡§æ‡§ì
    for job in context.job_queue.get_jobs_by_name(f"daily-{chat_id}"):
        job.schedule_removal()

    # ‡§∞‡•ã‡§ú‡§º 24 ‡§ò‡§Ç‡§ü‡•á ‡§™‡§∞ ‡§¶‡•ã‡§π‡§∞‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡§æ job (‡§Ö‡§≠‡•Ä ‡§ú‡§ø‡§∏ ‡§∏‡§Æ‡§Ø ‡§ö‡§æ‡§≤‡•Ç ‡§ï‡§∞‡•ã‡§ó‡•á ‡§µ‡§π‡•Ä base ‡§∞‡§π‡•á‡§ó‡§æ)
    context.job_queue.run_repeating(
        daily_quiz_job,
        interval=timedelta(days=1),
        first=5,  # 5 sec ‡§¨‡§æ‡§¶ ‡§™‡§π‡§≤‡§æ ‡§∏‡§µ‡§æ‡§≤
        name=f"daily-{chat_id}",
        data={"chat_id": chat_id},
    )

    await update.message.reply_text("‚úÖ ‡§á‡§∏ ‡§ö‡•à‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è daily quiz ‡§ö‡§æ‡§≤‡•Ç ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§")


# ---------- /daily_off ----------
async def daily_off(update: Update, context: ContextTypes.DEFAULT_TYPE):
    if not await is_admin(update, context):
        await update.message.reply_text("‡§ï‡•á‡§µ‡§≤ admin daily quiz ‡§¨‡§Ç‡§¶ ‡§ï‡§∞ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§")
        return

    chat_id = update.effective_chat.id
    jobs = context.job_queue.get_jobs_by_name(f"daily-{chat_id}")
    for job in jobs:
        job.schedule_removal()

    if jobs:
        await update.message.reply_text("‚õî Daily quiz ‡§¨‡§Ç‡§¶ ‡§ï‡§∞ ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§")
    else:
        await update.message.reply_text("‡§á‡§∏ ‡§ö‡•à‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à daily quiz ‡§∏‡•á‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§•‡§æ‡•§")


# ---------- MAIN ----------
def main():
    app = ApplicationBuilder().token(BOT_TOKEN).build()

    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("quiz", quiz_command))
    app.add_handler(CommandHandler("leaderboard", leaderboard))
    app.add_handler(CommandHandler("daily_on", daily_on))
    app.add_handler(CommandHandler("daily_off", daily_off))

    app.add_handler(CallbackQueryHandler(handle_answer, pattern=r"^answer_"))

    app.run_polling()


if __name__ == "__main__":
    main()
